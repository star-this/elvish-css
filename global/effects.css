/**
 * Elvish - Visual Effects (i-thîr)
 * 
 * "Thîr" (Sindarin) = face, expression, countenance
 * The visual appearance/effect applied to content.
 * 
 * Philosophy:
 * - Effects ARE surfaces, not decorations on surfaces
 * - Layout primitives position effect containers
 * - Effects provide background, borders, shadows as needed
 * - Shapes define the outline/mask of the element
 * 
 * Two orthogonal axes:
 * - effect="..." — what it LOOKS like (neon, frosted, shadow, etc.)
 * - shape="..."  — what it's SHAPED like (inverted, ticket, scalloped, etc.)
 * 
 * Usage:
 *   <i-thir effect="neon" padding="var(--s1)">Glowing card</i-thir>
 *   <i-thir effect="frosted" shape="inverted">Scalloped glass panel</i-thir>
 *   <i-thir shape="ticket">Ticket shape, no effect</i-thir>
 *   <p>Text with <i-thir effect="neon" inline>glowing words</i-thir></p>
 * 
 * Browser Support:
 * - Chrome/Edge: ✅ Full support
 * - Safari: ✅ Full support (backdrop-filter needs -webkit-)
 * - Firefox: ✅ Full support (backdrop-filter since v103)
 */

/* ==========================================================================
   BASE ELEMENT
   ========================================================================== */

i-thir {
  /* Block by default, can be made inline */
  display: block;
  
  /* Default padding (can be overridden) */
  padding: var(--thir-padding, var(--s1));
  
  /* Border-radius for shaped effects (shapes may override) */
  border-radius: var(--thir-radius, var(--s-1));
  
  /* Positioning context for pseudo-elements */
  position: relative;
  
  /* Prevent content overflow */
  overflow: hidden;
  
  /* Default colors (effects override these) */
  --thir-color-primary: var(--color-accent);
  --thir-color-secondary: var(--brand-complement);
  --thir-color-bg: var(--color-surface);
  --thir-color-text: var(--color-text);
  
  /* Shape radius (for inverted/scalloped shapes) */
  --thir-shape-radius: var(--invert-radius, 1rem);
  
  /* Transition for interactive effects */
  transition: 
    box-shadow 0.3s ease,
    transform 0.3s ease,
    filter 0.3s ease;
}

/* Inline variant for text decoration */
i-thir[inline] {
  display: inline;
  padding: 0.1em 0.3em;
  border-radius: 0.2em;
}

/* No padding variant */
i-thir[compact] {
  padding: 0;
}

/* ==========================================================================
   SHAPES (mask-based outlines)
   
   These define the element's silhouette using mask-image.
   Can be combined with any effect.
   
   Two attribute names for clarity:
   - corners="..." for corner modifications (inverted, top, bottom, etc.)
   - shape="..."   for overall shapes (ticket, scalloped, pill, etc.)
   ========================================================================== */

/* --- Inverted Corners (all four) --- */
i-thir[shape="inverted"],
i-thir[corners="inverted"],
i-thir[corners="all"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 0 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 0 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: top left, top right, bottom left, bottom right;
  mask-size: 51% 51%;
  mask-repeat: no-repeat;
}

/* --- Inverted Top Corners --- */
i-thir[shape="inverted-top"],
i-thir[corners="top"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 0 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    linear-gradient(black, black);
  mask-position: top left, top right, bottom;
  mask-size: 51% 51%, 51% 51%, 100% 50%;
  mask-repeat: no-repeat;
}

/* --- Inverted Bottom Corners --- */
i-thir[shape="inverted-bottom"],
i-thir[corners="bottom"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    linear-gradient(black, black),
    radial-gradient(circle at 0 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: top, bottom left, bottom right;
  mask-size: 100% 50%, 51% 51%, 51% 51%;
  mask-repeat: no-repeat;
}

/* --- Inverted Left Corners --- */
i-thir[shape="inverted-left"],
i-thir[corners="left"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 0 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 0 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    linear-gradient(black, black);
  mask-position: top left, bottom left, right;
  mask-size: 51% 51%, 51% 51%, 50% 100%;
  mask-repeat: no-repeat;
}

/* --- Inverted Right Corners --- */
i-thir[shape="inverted-right"],
i-thir[corners="right"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    linear-gradient(black, black),
    radial-gradient(circle at 100% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: left, top right, bottom right;
  mask-size: 50% 100%, 51% 51%, 51% 51%;
  mask-repeat: no-repeat;
}

/* --- Individual Corners --- */
i-thir[corners="tl"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  mask-image: radial-gradient(circle at 0 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-repeat: no-repeat;
}

i-thir[corners="tr"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  mask-image: radial-gradient(circle at 100% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-repeat: no-repeat;
}

i-thir[corners="bl"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  mask-image: radial-gradient(circle at 0 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-repeat: no-repeat;
}

i-thir[corners="br"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  mask-image: radial-gradient(circle at 100% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-repeat: no-repeat;
}

/* --- Ticket (horizontal side cutouts) --- */
i-thir[shape="ticket"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 0 50%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 50%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: left center, right center;
  mask-size: 51% 100%;
  mask-repeat: no-repeat;
}

/* --- Ticket Vertical (top/bottom cutouts) --- */
i-thir[shape="ticket-vertical"] {
  --_r: var(--thir-shape-radius);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 50% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 50% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: center top, center bottom;
  mask-size: 100% 51%;
  mask-repeat: no-repeat;
}

/* --- Scalloped Top --- */
i-thir[shape="scalloped-top"] {
  --_r: var(--thir-shape-radius);
  --_size: calc(var(--_r) * 2);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 50% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    linear-gradient(black, black);
  mask-position: center top, 0 var(--_r);
  mask-size: var(--_size) var(--_size), 100% calc(100% - var(--_r));
  mask-repeat: repeat-x, no-repeat;
}

/* --- Scalloped Bottom --- */
i-thir[shape="scalloped-bottom"] {
  --_r: var(--thir-shape-radius);
  --_size: calc(var(--_r) * 2);
  border-radius: 0;
  
  mask-image: 
    linear-gradient(black, black),
    radial-gradient(circle at 50% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: 0 0, center bottom;
  mask-size: 100% calc(100% - var(--_r)), var(--_size) var(--_size);
  mask-repeat: no-repeat, repeat-x;
}

/* --- Scalloped Left --- */
i-thir[shape="scalloped-left"] {
  --_r: var(--thir-shape-radius);
  --_size: calc(var(--_r) * 2);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 0 50%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    linear-gradient(black, black);
  mask-position: left center, var(--_r) 0;
  mask-size: var(--_size) var(--_size), calc(100% - var(--_r)) 100%;
  mask-repeat: repeat-y, no-repeat;
}

/* --- Scalloped Right --- */
i-thir[shape="scalloped-right"] {
  --_r: var(--thir-shape-radius);
  --_size: calc(var(--_r) * 2);
  border-radius: 0;
  
  mask-image: 
    linear-gradient(black, black),
    radial-gradient(circle at 100% 50%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: 0 0, right center;
  mask-size: calc(100% - var(--_r)) 100%, var(--_size) var(--_size);
  mask-repeat: no-repeat, repeat-y;
}

/* --- Scalloped All Edges --- */
i-thir[shape="scalloped"] {
  --_r: var(--thir-shape-radius);
  --_size: calc(var(--_r) * 2);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 50% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 50% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 0 50%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 100% 50%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: center top, center bottom, left center, right center;
  mask-size: var(--_size) var(--_size);
  mask-repeat: repeat-x, repeat-x, repeat-y, repeat-y;
}

/* --- Notch Top (single centered notch) --- */
i-thir[shape="notch-top"] {
  --_r: var(--thir-shape-radius);
  --_notch-width: var(--thir-notch-width, 4rem);
  border-radius: 0;
  
  mask-image: 
    radial-gradient(circle at 100% 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 0 0, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    linear-gradient(black, black);
  mask-position: 
    calc(50% - var(--_notch-width) / 2 - var(--_r)) 0,
    calc(50% + var(--_notch-width) / 2) 0,
    0 var(--_r);
  mask-size: 
    calc(50% - var(--_notch-width) / 2 + var(--_r)) 100%,
    calc(50% - var(--_notch-width) / 2 + var(--_r)) 100%,
    100% calc(100% - var(--_r));
  mask-repeat: no-repeat;
}

/* --- Notch Bottom --- */
i-thir[shape="notch-bottom"] {
  --_r: var(--thir-shape-radius);
  --_notch-width: var(--thir-notch-width, 4rem);
  border-radius: 0;
  
  mask-image: 
    linear-gradient(black, black),
    radial-gradient(circle at 100% 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px)),
    radial-gradient(circle at 0 100%, transparent 0, transparent var(--_r), black calc(var(--_r) + 1px));
  mask-position: 
    0 0,
    calc(50% - var(--_notch-width) / 2 - var(--_r)) 0,
    calc(50% + var(--_notch-width) / 2) 0;
  mask-size: 
    100% calc(100% - var(--_r)),
    calc(50% - var(--_notch-width) / 2 + var(--_r)) 100%,
    calc(50% - var(--_notch-width) / 2 + var(--_r)) 100%;
  mask-repeat: no-repeat;
}

/* --- Rounded (explicit, uses border-radius) --- */
i-thir[shape="rounded"] {
  border-radius: var(--thir-shape-radius);
}

/* --- Pill (fully rounded ends) --- */
i-thir[shape="pill"] {
  border-radius: 9999px;
}

/* --- Square (no radius) --- */
i-thir[shape="square"] {
  border-radius: 0;
}

/* ==========================================================================
   EFFECT: NEON
   
   Glowing outline effect, like neon signs.
   Uses multiple box-shadows for the glow layers.
   ========================================================================== */

i-thir[effect="neon"] {
  --neon-color: var(--thir-color-primary, oklch(70% 0.25 200));
  --neon-intensity: 1;
  --neon-spread: 2px;
  
  background: oklch(15% 0.02 var(--neon-hue, 200));
  color: var(--neon-color);
  border: 2px solid var(--neon-color);
  
  box-shadow:
    /* Inner glow */
    inset 0 0 calc(10px * var(--neon-intensity)) oklch(from var(--neon-color) l c h / 0.3),
    /* Core glow */
    0 0 calc(5px * var(--neon-intensity)) var(--neon-color),
    /* Mid glow */
    0 0 calc(20px * var(--neon-intensity)) var(--neon-color),
    /* Outer glow */
    0 0 calc(40px * var(--neon-intensity)) oklch(from var(--neon-color) l c h / 0.5),
    /* Spread glow */
    0 0 calc(80px * var(--neon-intensity)) oklch(from var(--neon-color) l c h / 0.2);
}

i-thir[effect="neon"]:hover {
  --neon-intensity: 1.3;
}

/* Neon color variants */
i-thir[effect="neon"][color="pink"] {
  --neon-color: oklch(70% 0.25 350);
  --neon-hue: 350;
}

i-thir[effect="neon"][color="cyan"] {
  --neon-color: oklch(75% 0.2 200);
  --neon-hue: 200;
}

i-thir[effect="neon"][color="green"] {
  --neon-color: oklch(75% 0.25 145);
  --neon-hue: 145;
}

i-thir[effect="neon"][color="orange"] {
  --neon-color: oklch(75% 0.2 60);
  --neon-hue: 60;
}

i-thir[effect="neon"][color="purple"] {
  --neon-color: oklch(65% 0.25 300);
  --neon-hue: 300;
}

/* Neon text (inline) */
i-thir[effect="neon"][inline] {
  background: transparent;
  border: none;
  box-shadow: none;
  text-shadow:
    0 0 5px var(--neon-color),
    0 0 10px var(--neon-color),
    0 0 20px var(--neon-color),
    0 0 40px oklch(from var(--neon-color) l c h / 0.5);
}

/* ==========================================================================
   EFFECT: FROSTED / GLASS
   
   Blurred background effect, like frosted glass.
   Uses backdrop-filter.
   ========================================================================== */

i-thir[effect="frosted"],
i-thir[effect="glass"] {
  --frost-blur: 10px;
  --frost-opacity: 0.7;
  --frost-saturation: 1.2;
  
  background: oklch(from var(--thir-color-bg) l c h / var(--frost-opacity));
  -webkit-backdrop-filter: blur(var(--frost-blur)) saturate(var(--frost-saturation));
  backdrop-filter: blur(var(--frost-blur)) saturate(var(--frost-saturation));
  border: 1px solid oklch(from var(--thir-color-bg) calc(l + 0.1) c h / 0.3);
}

/* Light frosted variant */
i-thir[effect="frosted"][variant="light"],
i-thir[effect="glass"][variant="light"] {
  background: oklch(98% 0 0 / 0.6);
  border-color: oklch(100% 0 0 / 0.3);
}

/* Dark frosted variant */
i-thir[effect="frosted"][variant="dark"],
i-thir[effect="glass"][variant="dark"] {
  background: oklch(15% 0 0 / 0.7);
  border-color: oklch(30% 0 0 / 0.3);
  color: oklch(95% 0 0);
}

/* ==========================================================================
   EFFECT: GLASSMORPHISM
   
   Modern glass card effect with subtle gradient and border.
   Popular in UI design since ~2020.
   ========================================================================== */

i-thir[effect="glassmorphism"] {
  --glass-blur: 16px;
  --glass-opacity: 0.25;
  
  background: linear-gradient(
    135deg,
    oklch(100% 0 0 / var(--glass-opacity)),
    oklch(100% 0 0 / calc(var(--glass-opacity) * 0.5))
  );
  -webkit-backdrop-filter: blur(var(--glass-blur));
  backdrop-filter: blur(var(--glass-blur));
  border: 1px solid oklch(100% 0 0 / 0.2);
  box-shadow: 
    0 8px 32px oklch(0% 0 0 / 0.1),
    inset 0 0 0 1px oklch(100% 0 0 / 0.1);
}

/* Dark glassmorphism */
i-thir[effect="glassmorphism"][variant="dark"] {
  background: linear-gradient(
    135deg,
    oklch(20% 0 0 / 0.6),
    oklch(10% 0 0 / 0.4)
  );
  border-color: oklch(40% 0 0 / 0.3);
  color: oklch(95% 0 0);
}

/* ==========================================================================
   EFFECT: NEUMORPHISM
   
   Soft UI with extruded/pressed appearance.
   Uses dual shadows (light and dark) to create depth.
   ========================================================================== */

i-thir[effect="neumorphism"],
i-thir[effect="soft"] {
  --neu-bg: var(--thir-color-bg, oklch(92% 0 0));
  --neu-distance: 6px;
  --neu-blur: 12px;
  --neu-intensity: 0.15;
  
  background: var(--neu-bg);
  border: none;
  box-shadow:
    /* Light shadow (top-left) */
    calc(var(--neu-distance) * -1) calc(var(--neu-distance) * -1) var(--neu-blur) 
      oklch(from var(--neu-bg) calc(l + 0.08) c h),
    /* Dark shadow (bottom-right) */
    var(--neu-distance) var(--neu-distance) var(--neu-blur)
      oklch(from var(--neu-bg) calc(l - var(--neu-intensity)) c h);
}

/* Pressed/inset variant */
i-thir[effect="neumorphism"][variant="inset"],
i-thir[effect="soft"][variant="inset"],
i-thir[effect="neumorphism"]:active {
  box-shadow:
    /* Inset light shadow */
    inset calc(var(--neu-distance) * -1) calc(var(--neu-distance) * -1) var(--neu-blur) 
      oklch(from var(--neu-bg) calc(l + 0.08) c h),
    /* Inset dark shadow */
    inset var(--neu-distance) var(--neu-distance) var(--neu-blur)
      oklch(from var(--neu-bg) calc(l - var(--neu-intensity)) c h);
}

/* Dark neumorphism */
i-thir[effect="neumorphism"][variant="dark"],
i-thir[effect="soft"][variant="dark"] {
  --neu-bg: oklch(25% 0 0);
  color: oklch(85% 0 0);
}

/* ==========================================================================
   EFFECT: EMBOSSED / RAISED
   
   Appears to pop out of the surface.
   ========================================================================== */

i-thir[effect="embossed"],
i-thir[effect="raised"] {
  background: var(--thir-color-bg);
  border: 1px solid oklch(from var(--thir-color-bg) calc(l - 0.1) c h);
  box-shadow:
    /* Bottom edge highlight */
    inset 0 -2px 0 oklch(from var(--thir-color-bg) calc(l - 0.15) c h),
    /* Top edge highlight */
    inset 0 2px 0 oklch(from var(--thir-color-bg) calc(l + 0.1) c h),
    /* Drop shadow */
    0 4px 8px oklch(0% 0 0 / 0.15);
}

i-thir[effect="embossed"]:active,
i-thir[effect="raised"]:active {
  box-shadow:
    inset 0 2px 4px oklch(0% 0 0 / 0.1);
  transform: translateY(2px);
}

/* ==========================================================================
   EFFECT: DEBOSSED / INSET
   
   Appears pressed into the surface.
   ========================================================================== */

i-thir[effect="debossed"],
i-thir[effect="inset"] {
  background: oklch(from var(--thir-color-bg) calc(l - 0.05) c h);
  border: 1px solid oklch(from var(--thir-color-bg) calc(l - 0.15) c h);
  box-shadow:
    /* Top inner shadow */
    inset 0 2px 4px oklch(0% 0 0 / 0.15),
    /* Bottom highlight */
    inset 0 -1px 0 oklch(100% 0 0 / 0.1);
}

/* ==========================================================================
   EFFECT: GRADIENT BORDER
   
   Colorful animated gradient border.
   Uses background trick (gradient on padding area).
   ========================================================================== */

i-thir[effect="gradient-border"] {
  --gradient-size: 3px;
  --gradient-angle: 45deg;
  --gradient-speed: 3s;
  
  background: 
    linear-gradient(var(--thir-color-bg), var(--thir-color-bg)) padding-box,
    linear-gradient(
      var(--gradient-angle),
      var(--thir-color-primary),
      var(--thir-color-secondary),
      var(--thir-color-primary)
    ) border-box;
  border: var(--gradient-size) solid transparent;
}

/* Animated gradient */
i-thir[effect="gradient-border"][animated] {
  background: 
    linear-gradient(var(--thir-color-bg), var(--thir-color-bg)) padding-box,
    conic-gradient(
      from var(--gradient-angle),
      var(--thir-color-primary),
      var(--thir-color-secondary),
      oklch(70% 0.2 100),
      var(--thir-color-primary)
    ) border-box;
  animation: gradient-spin var(--gradient-speed) linear infinite;
}

@keyframes gradient-spin {
  to { --gradient-angle: 405deg; }
}

@property --gradient-angle {
  syntax: '<angle>';
  initial-value: 45deg;
  inherits: false;
}

/* ==========================================================================
   EFFECT: SHIMMER / SHINE
   
   Animated light sweep across the element.
   ========================================================================== */

i-thir[effect="shimmer"],
i-thir[effect="shine"] {
  background: var(--thir-color-bg);
  overflow: hidden;
}

i-thir[effect="shimmer"]::after,
i-thir[effect="shine"]::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    105deg,
    transparent 40%,
    oklch(100% 0 0 / 0.3) 45%,
    oklch(100% 0 0 / 0.5) 50%,
    oklch(100% 0 0 / 0.3) 55%,
    transparent 60%
  );
  background-size: 200% 100%;
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* Shimmer on hover only */
i-thir[effect="shimmer"][on-hover]::after,
i-thir[effect="shine"][on-hover]::after {
  animation: none;
  background-position: 200% 0;
  transition: background-position 0.6s ease;
}

i-thir[effect="shimmer"][on-hover]:hover::after,
i-thir[effect="shine"][on-hover]:hover::after {
  background-position: -200% 0;
}

/* ==========================================================================
   EFFECT: HOLOGRAPHIC
   
   Iridescent color-shifting effect.
   Changes hue based on position/angle.
   ========================================================================== */

i-thir[effect="holographic"],
i-thir[effect="iridescent"] {
  --holo-angle: 135deg;
  
  background: linear-gradient(
    var(--holo-angle),
    oklch(85% 0.15 0),
    oklch(85% 0.15 60),
    oklch(85% 0.15 120),
    oklch(85% 0.15 180),
    oklch(85% 0.15 240),
    oklch(85% 0.15 300),
    oklch(85% 0.15 360)
  );
  background-size: 400% 400%;
  animation: holographic 8s ease infinite;
  color: oklch(20% 0 0);
}

@keyframes holographic {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Holographic with mouse tracking (requires JS) */
i-thir[effect="holographic"][interactive] {
  animation: none;
  background-position: var(--mouse-x, 50%) var(--mouse-y, 50%);
  transition: background-position 0.1s ease;
}

/* ==========================================================================
   EFFECT: GRAIN / NOISE
   
   Film grain texture overlay.
   Uses SVG filter for noise generation.
   ========================================================================== */

i-thir[effect="grain"],
i-thir[effect="noise"] {
  --grain-opacity: 0.15;
  --grain-size: 100;
  
  background: var(--thir-color-bg);
}

i-thir[effect="grain"]::after,
i-thir[effect="noise"]::after {
  content: '';
  position: absolute;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity: var(--grain-opacity);
  pointer-events: none;
  mix-blend-mode: overlay;
}

/* ==========================================================================
   EFFECT: RETRO / PIXELATED
   
   Retro pixel/8-bit aesthetic.
   Uses stepped gradients.
   ========================================================================== */

i-thir[effect="retro"],
i-thir[effect="pixel"] {
  --pixel-size: 4px;
  
  background: var(--thir-color-primary);
  border-radius: 0;
  image-rendering: pixelated;
  
  /* Pixelated border using box-shadow */
  box-shadow:
    var(--pixel-size) 0 0 var(--thir-color-bg),
    calc(var(--pixel-size) * -1) 0 0 var(--thir-color-bg),
    0 var(--pixel-size) 0 var(--thir-color-bg),
    0 calc(var(--pixel-size) * -1) 0 var(--thir-color-bg),
    calc(var(--pixel-size) * 2) var(--pixel-size) 0 oklch(from var(--thir-color-primary) calc(l - 0.2) c h),
    var(--pixel-size) calc(var(--pixel-size) * 2) 0 oklch(from var(--thir-color-primary) calc(l - 0.2) c h);
}

/* ==========================================================================
   EFFECT: OUTLINE / STROKE
   
   Multi-layered outline effect.
   Good for text and cards.
   ========================================================================== */

i-thir[effect="outline"],
i-thir[effect="stroke"] {
  --outline-width: 3px;
  --outline-color: var(--thir-color-primary);
  
  background: transparent;
  border: var(--outline-width) solid var(--outline-color);
  color: var(--outline-color);
}

/* Double outline */
i-thir[effect="outline"][variant="double"],
i-thir[effect="stroke"][variant="double"] {
  box-shadow:
    0 0 0 calc(var(--outline-width) + 3px) var(--thir-color-bg),
    0 0 0 calc(var(--outline-width) + 6px) var(--outline-color);
}

/* Outline text (inline) */
i-thir[effect="outline"][inline],
i-thir[effect="stroke"][inline] {
  -webkit-text-stroke: var(--outline-width) var(--outline-color);
  color: transparent;
  border: none;
}

/* ==========================================================================
   EFFECT: SHADOW (Utility)
   
   Pre-configured shadow levels.
   ========================================================================== */

i-thir[effect="shadow"] {
  background: var(--thir-color-bg);
  box-shadow: 0 4px 12px oklch(0% 0 0 / 0.15);
}

i-thir[effect="shadow"][level="sm"] {
  box-shadow: 0 2px 4px oklch(0% 0 0 / 0.1);
}

i-thir[effect="shadow"][level="md"] {
  box-shadow: 0 4px 12px oklch(0% 0 0 / 0.15);
}

i-thir[effect="shadow"][level="lg"] {
  box-shadow: 
    0 8px 24px oklch(0% 0 0 / 0.15),
    0 2px 8px oklch(0% 0 0 / 0.1);
}

i-thir[effect="shadow"][level="xl"] {
  box-shadow:
    0 16px 48px oklch(0% 0 0 / 0.2),
    0 4px 16px oklch(0% 0 0 / 0.1);
}

/* Colored shadow */
i-thir[effect="shadow"][colored] {
  box-shadow: 0 8px 24px oklch(from var(--thir-color-primary) l c h / 0.3);
}

/* ==========================================================================
   EFFECT: BLUR
   
   Blurred element (not backdrop).
   ========================================================================== */

i-thir[effect="blur"] {
  --blur-amount: 4px;
  filter: blur(var(--blur-amount));
}

i-thir[effect="blur"]:hover {
  filter: blur(0);
}

/* ==========================================================================
   TIER 2: LOW-LEVEL SHORTCUTS
   
   Single-property conveniences for common visual adjustments.
   Can be combined with effects, corners, and shapes.
   ========================================================================== */

/* ---------------------------------------------------------------------------
   FILTER SHORTCUTS
   
   CSS filter property shortcuts for quick adjustments.
   --------------------------------------------------------------------------- */

/* Blur filters */
i-thir[filter="blur-xs"]   { filter: blur(2px); }
i-thir[filter="blur-sm"]   { filter: blur(4px); }
i-thir[filter="blur"]      { filter: blur(8px); }
i-thir[filter="blur-md"]   { filter: blur(12px); }
i-thir[filter="blur-lg"]   { filter: blur(16px); }
i-thir[filter="blur-xl"]   { filter: blur(24px); }
i-thir[filter="blur-2xl"]  { filter: blur(40px); }

/* Grayscale */
i-thir[filter="grayscale"]      { filter: grayscale(100%); }
i-thir[filter="grayscale-half"] { filter: grayscale(50%); }

/* Sepia (vintage) */
i-thir[filter="sepia"]      { filter: sepia(100%); }
i-thir[filter="sepia-half"] { filter: sepia(50%); }

/* Brightness */
i-thir[filter="brightness-down"]  { filter: brightness(0.75); }
i-thir[filter="brightness-dim"]   { filter: brightness(0.5); }
i-thir[filter="brightness-up"]    { filter: brightness(1.25); }
i-thir[filter="brightness-high"]  { filter: brightness(1.5); }

/* Contrast */
i-thir[filter="contrast-down"] { filter: contrast(0.75); }
i-thir[filter="contrast-flat"] { filter: contrast(0.5); }
i-thir[filter="contrast-up"]   { filter: contrast(1.25); }
i-thir[filter="contrast-high"] { filter: contrast(1.5); }

/* Saturation */
i-thir[filter="saturate-down"]  { filter: saturate(0.5); }
i-thir[filter="saturate-none"]  { filter: saturate(0); }
i-thir[filter="saturate-up"]    { filter: saturate(1.5); }
i-thir[filter="saturate-vivid"] { filter: saturate(2); }

/* Invert */
i-thir[filter="invert"]      { filter: invert(100%); }
i-thir[filter="invert-half"] { filter: invert(50%); }

/* Hue rotation */
i-thir[filter="hue-30"]  { filter: hue-rotate(30deg); }
i-thir[filter="hue-60"]  { filter: hue-rotate(60deg); }
i-thir[filter="hue-90"]  { filter: hue-rotate(90deg); }
i-thir[filter="hue-120"] { filter: hue-rotate(120deg); }
i-thir[filter="hue-180"] { filter: hue-rotate(180deg); }
i-thir[filter="hue-270"] { filter: hue-rotate(270deg); }

/* Drop shadow (for transparent images/SVGs) */
i-thir[filter="drop-shadow-sm"] { filter: drop-shadow(0 1px 2px oklch(0% 0 0 / 0.2)); }
i-thir[filter="drop-shadow"]    { filter: drop-shadow(0 2px 4px oklch(0% 0 0 / 0.25)); }
i-thir[filter="drop-shadow-lg"] { filter: drop-shadow(0 4px 8px oklch(0% 0 0 / 0.3)); }

/* Combination presets */
i-thir[filter="vintage"] { 
  filter: sepia(40%) contrast(1.1) brightness(0.9) saturate(0.8); 
}
i-thir[filter="dramatic"] { 
  filter: contrast(1.3) brightness(0.95) saturate(1.2); 
}
i-thir[filter="faded"] { 
  filter: contrast(0.9) brightness(1.1) saturate(0.7); 
}
i-thir[filter="noir"] { 
  filter: grayscale(100%) contrast(1.2) brightness(0.9); 
}

/* ---------------------------------------------------------------------------
   BACKDROP SHORTCUTS
   
   CSS backdrop-filter for effects on content behind the element.
   --------------------------------------------------------------------------- */

i-thir[backdrop="blur-xs"]  { -webkit-backdrop-filter: blur(2px);  backdrop-filter: blur(2px); }
i-thir[backdrop="blur-sm"]  { -webkit-backdrop-filter: blur(4px);  backdrop-filter: blur(4px); }
i-thir[backdrop="blur"]     { -webkit-backdrop-filter: blur(8px);  backdrop-filter: blur(8px); }
i-thir[backdrop="blur-md"]  { -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px); }
i-thir[backdrop="blur-lg"]  { -webkit-backdrop-filter: blur(16px); backdrop-filter: blur(16px); }
i-thir[backdrop="blur-xl"]  { -webkit-backdrop-filter: blur(24px); backdrop-filter: blur(24px); }

i-thir[backdrop="dim"] { 
  -webkit-backdrop-filter: brightness(0.7); 
  backdrop-filter: brightness(0.7); 
}
i-thir[backdrop="dim-heavy"] { 
  -webkit-backdrop-filter: brightness(0.4); 
  backdrop-filter: brightness(0.4); 
}
i-thir[backdrop="brighten"] { 
  -webkit-backdrop-filter: brightness(1.3); 
  backdrop-filter: brightness(1.3); 
}

i-thir[backdrop="saturate"] { 
  -webkit-backdrop-filter: saturate(1.5); 
  backdrop-filter: saturate(1.5); 
}
i-thir[backdrop="desaturate"] { 
  -webkit-backdrop-filter: saturate(0.5); 
  backdrop-filter: saturate(0.5); 
}
i-thir[backdrop="grayscale"] { 
  -webkit-backdrop-filter: grayscale(100%); 
  backdrop-filter: grayscale(100%); 
}

/* Combination backdrop effects */
i-thir[backdrop="frost"] { 
  -webkit-backdrop-filter: blur(10px) saturate(1.2); 
  backdrop-filter: blur(10px) saturate(1.2); 
}
i-thir[backdrop="frost-heavy"] { 
  -webkit-backdrop-filter: blur(20px) saturate(1.3); 
  backdrop-filter: blur(20px) saturate(1.3); 
}

/* ---------------------------------------------------------------------------
   BLEND MODE SHORTCUTS
   
   CSS mix-blend-mode for compositing with background.
   --------------------------------------------------------------------------- */

i-thir[blend="multiply"]    { mix-blend-mode: multiply; }
i-thir[blend="screen"]      { mix-blend-mode: screen; }
i-thir[blend="overlay"]     { mix-blend-mode: overlay; }
i-thir[blend="darken"]      { mix-blend-mode: darken; }
i-thir[blend="lighten"]     { mix-blend-mode: lighten; }
i-thir[blend="color-dodge"] { mix-blend-mode: color-dodge; }
i-thir[blend="color-burn"]  { mix-blend-mode: color-burn; }
i-thir[blend="hard-light"]  { mix-blend-mode: hard-light; }
i-thir[blend="soft-light"]  { mix-blend-mode: soft-light; }
i-thir[blend="difference"]  { mix-blend-mode: difference; }
i-thir[blend="exclusion"]   { mix-blend-mode: exclusion; }
i-thir[blend="hue"]         { mix-blend-mode: hue; }
i-thir[blend="saturation"]  { mix-blend-mode: saturation; }
i-thir[blend="color"]       { mix-blend-mode: color; }
i-thir[blend="luminosity"]  { mix-blend-mode: luminosity; }

/* Isolation for blend mode containment */
i-thir[isolate] { isolation: isolate; }

/* ---------------------------------------------------------------------------
   HOVER & TOUCH INTERACTION SHORTCUTS
   
   Hover effects for desktop, with optional touch support for mobile.
   
   Usage:
     <i-thir hover="lift">Desktop hover only</i-thir>
     <i-thir hover="lift" touch>Both hover AND long-press</i-thir>
     <i-thir hover="lift" touch="pulse">Different per platform</i-thir>
   
   The [touch] attribute enables JS-based touch interactions.
   When [touch] has no value, it uses the same effect as [hover].
   --------------------------------------------------------------------------- */

/* Base: ensure transitions work */
i-thir[hover] {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

/* Touch activation class (added by JS on long-press) */
i-thir[touch].touch-active {
  /* Same styles as :hover will be applied */
}

/* Lift (raises up with shadow) */
i-thir[hover="lift"]:hover,
i-thir[touch="lift"].touch-active,
i-thir[hover="lift"][touch]:not([touch*="="]).touch-active {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px oklch(0% 0 0 / 0.15);
}

i-thir[hover="lift-sm"]:hover,
i-thir[touch="lift-sm"].touch-active,
i-thir[hover="lift-sm"][touch]:not([touch*="="]).touch-active {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px oklch(0% 0 0 / 0.1);
}

i-thir[hover="lift-lg"]:hover,
i-thir[touch="lift-lg"].touch-active,
i-thir[hover="lift-lg"][touch]:not([touch*="="]).touch-active {
  transform: translateY(-8px);
  box-shadow: 0 16px 40px oklch(0% 0 0 / 0.2);
}

/* Sink (presses down) */
i-thir[hover="sink"]:hover,
i-thir[touch="sink"].touch-active,
i-thir[hover="sink"][touch]:not([touch*="="]).touch-active {
  transform: translateY(2px);
}

i-thir[hover="sink"]:active {
  transform: translateY(4px);
}

/* Scale - Grow */
i-thir[hover="grow"]:hover,
i-thir[touch="grow"].touch-active,
i-thir[hover="grow"][touch]:not([touch*="="]).touch-active {
  transform: scale(1.05);
}

i-thir[hover="grow-sm"]:hover,
i-thir[touch="grow-sm"].touch-active,
i-thir[hover="grow-sm"][touch]:not([touch*="="]).touch-active {
  transform: scale(1.02);
}

i-thir[hover="grow-lg"]:hover,
i-thir[touch="grow-lg"].touch-active,
i-thir[hover="grow-lg"][touch]:not([touch*="="]).touch-active {
  transform: scale(1.1);
}

/* Scale - Shrink */
i-thir[hover="shrink"]:hover,
i-thir[touch="shrink"].touch-active,
i-thir[hover="shrink"][touch]:not([touch*="="]).touch-active {
  transform: scale(0.95);
}

i-thir[hover="shrink-sm"]:hover,
i-thir[touch="shrink-sm"].touch-active,
i-thir[hover="shrink-sm"][touch]:not([touch*="="]).touch-active {
  transform: scale(0.98);
}

/* Tilt (rotation) */
i-thir[hover="tilt"]:hover,
i-thir[touch="tilt"].touch-active,
i-thir[hover="tilt"][touch]:not([touch*="="]).touch-active {
  transform: rotate(2deg);
}

i-thir[hover="tilt-left"]:hover,
i-thir[touch="tilt-left"].touch-active,
i-thir[hover="tilt-left"][touch]:not([touch*="="]).touch-active {
  transform: rotate(-3deg);
}

i-thir[hover="tilt-right"]:hover,
i-thir[touch="tilt-right"].touch-active,
i-thir[hover="tilt-right"][touch]:not([touch*="="]).touch-active {
  transform: rotate(3deg);
}

/* Perspective tilt (3D) */
i-thir[hover="tilt-3d"] {
  transform-style: preserve-3d;
  perspective: 1000px;
}

i-thir[hover="tilt-3d"]:hover,
i-thir[touch="tilt-3d"].touch-active,
i-thir[hover="tilt-3d"][touch]:not([touch*="="]).touch-active {
  transform: rotateX(5deg) rotateY(-5deg);
}

/* Wiggle (playful) */
@keyframes thir-wiggle {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-3deg); }
  75% { transform: rotate(3deg); }
}

i-thir[hover="wiggle"]:hover,
i-thir[touch="wiggle"].touch-active,
i-thir[hover="wiggle"][touch]:not([touch*="="]).touch-active {
  animation: thir-wiggle 0.3s ease-in-out;
}

/* Pulse */
@keyframes thir-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

i-thir[hover="pulse"]:hover,
i-thir[touch="pulse"].touch-active,
i-thir[hover="pulse"][touch]:not([touch*="="]).touch-active {
  animation: thir-pulse 0.6s ease-in-out infinite;
}

/* Jiggle */
@keyframes thir-jiggle {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-4px); }
  75% { transform: translateX(4px); }
}

i-thir[hover="jiggle"]:hover,
i-thir[touch="jiggle"].touch-active,
i-thir[hover="jiggle"][touch]:not([touch*="="]).touch-active {
  animation: thir-jiggle 0.2s ease-in-out;
}

/* Pop (scale up then settle) */
@keyframes thir-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1.05); }
}

i-thir[hover="pop"]:hover,
i-thir[touch="pop"].touch-active,
i-thir[hover="pop"][touch]:not([touch*="="]).touch-active {
  animation: thir-pop 0.2s ease-out forwards;
}

/* Glow (brightness increase) */
i-thir[hover="glow"]:hover,
i-thir[touch="glow"].touch-active,
i-thir[hover="glow"][touch]:not([touch*="="]).touch-active {
  filter: brightness(1.15);
}

/* Dim (brightness decrease) */
i-thir[hover="dim"]:hover,
i-thir[touch="dim"].touch-active,
i-thir[hover="dim"][touch]:not([touch*="="]).touch-active {
  filter: brightness(0.85);
}

/* Always-on transforms (not hover-based) */
i-thir[rotate="45"]  { transform: rotate(45deg); }
i-thir[rotate="90"]  { transform: rotate(90deg); }
i-thir[rotate="180"] { transform: rotate(180deg); }
i-thir[rotate="-45"] { transform: rotate(-45deg); }
i-thir[rotate="-90"] { transform: rotate(-90deg); }

i-thir[skew="x"]  { transform: skewX(5deg); }
i-thir[skew="y"]  { transform: skewY(5deg); }
i-thir[skew="xy"] { transform: skew(5deg, 5deg); }

i-thir[flip="x"] { transform: scaleX(-1); }
i-thir[flip="y"] { transform: scaleY(-1); }
i-thir[flip="both"] { transform: scale(-1, -1); }

/* ---------------------------------------------------------------------------
   OPACITY SHORTCUTS
   --------------------------------------------------------------------------- */

i-thir[opacity="0"]   { opacity: 0; }
i-thir[opacity="10"]  { opacity: 0.1; }
i-thir[opacity="25"]  { opacity: 0.25; }
i-thir[opacity="50"]  { opacity: 0.5; }
i-thir[opacity="75"]  { opacity: 0.75; }
i-thir[opacity="90"]  { opacity: 0.9; }
i-thir[opacity="100"] { opacity: 1; }

/* Hover opacity changes */
i-thir[hover-opacity="fade"]:hover { opacity: 0.7; }
i-thir[hover-opacity="dim"]:hover  { opacity: 0.5; }
i-thir[hover-opacity="full"]:hover { opacity: 1; }

/* ---------------------------------------------------------------------------
   CURSOR SHORTCUTS
   --------------------------------------------------------------------------- */

i-thir[cursor="pointer"]  { cursor: pointer; }
i-thir[cursor="grab"]     { cursor: grab; }
i-thir[cursor="grabbing"] { cursor: grabbing; }
i-thir[cursor="zoom-in"]  { cursor: zoom-in; }
i-thir[cursor="zoom-out"] { cursor: zoom-out; }
i-thir[cursor="not-allowed"] { cursor: not-allowed; }
i-thir[cursor="help"]     { cursor: help; }
i-thir[cursor="wait"]     { cursor: wait; }
i-thir[cursor="crosshair"] { cursor: crosshair; }
i-thir[cursor="text"]     { cursor: text; }
i-thir[cursor="move"]     { cursor: move; }
i-thir[cursor="none"]     { cursor: none; }

/* ==========================================================================
   TIER 3: CSS CUSTOM PROPERTIES (Customization Layer)
   
   Fine-tune any effect by overriding these variables.
   ========================================================================== */

i-thir {
  /* === Color Configuration === */
  --thir-color-primary: var(--color-accent, oklch(60% 0.2 250));
  --thir-color-secondary: var(--brand-complement, oklch(60% 0.2 30));
  --thir-color-bg: var(--color-surface, oklch(98% 0 0));
  --thir-color-text: var(--color-text, oklch(20% 0 0));
  --thir-color-border: var(--color-border, oklch(80% 0 0));
  
  /* === Shape Configuration === */
  --thir-shape-radius: var(--invert-radius, 1rem);
  --thir-border-radius: var(--s-1, 0.5rem);
  --thir-notch-width: 4rem;
  
  /* === Spacing === */
  --thir-padding: var(--s1, 1rem);
  
  /* === Effect Intensities === */
  --thir-blur-amount: 8px;
  --thir-shadow-color: oklch(0% 0 0 / 0.15);
  --thir-shadow-offset: 4px;
  --thir-shadow-blur: 12px;
  --thir-glow-spread: 20px;
  
  /* === Neon Effect === */
  --thir-neon-color: var(--thir-color-primary);
  --thir-neon-intensity: 1;
  --thir-neon-bg: oklch(15% 0.02 240);
  
  /* === Glass Effect === */
  --thir-glass-blur: 10px;
  --thir-glass-opacity: 0.7;
  --thir-glass-saturation: 1.2;
  
  /* === Neumorphism === */
  --thir-neu-bg: oklch(92% 0 0);
  --thir-neu-distance: 6px;
  --thir-neu-blur: 12px;
  --thir-neu-intensity: 0.15;
  
  /* === Animation === */
  --thir-transition-duration: 0.3s;
  --thir-transition-timing: ease;
  
  /* === Grain Effect === */
  --thir-grain-opacity: 0.15;
}

/* ==========================================================================
   TIER 4: RAW CSS ESCAPE HATCH
   
   For truly custom effects, use style="" or external CSS.
   The [custom] attribute removes default styling.
   ========================================================================== */

/* Remove all default styles - pure container for custom CSS */
i-thir[custom] {
  padding: 0;
  border-radius: 0;
  background: transparent;
  box-shadow: none;
  filter: none;
  mask: none;
  transform: none;
  transition: none;
}

/* Partial reset - keep layout, remove visuals */
i-thir[custom="visual"] {
  background: transparent;
  box-shadow: none;
  filter: none;
  border: none;
}

/* Partial reset - keep visuals, remove shape */
i-thir[custom="shape"] {
  mask: none;
  border-radius: 0;
}

/* ==========================================================================
   REDUCED MOTION
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  i-thir[hover],
  i-thir[hover="lift"]:hover,
  i-thir[hover="grow"]:hover,
  i-thir[hover="shrink"]:hover,
  i-thir[hover="tilt"]:hover,
  i-thir[hover="wiggle"]:hover,
  i-thir[hover="pulse"]:hover,
  i-thir[hover="jiggle"]:hover,
  i-thir[hover="pop"]:hover,
  i-thir[touch].touch-active {
    animation: none !important;
    transform: none !important;
    transition: none !important;
  }
}

/* ==========================================================================
   DARK MODE ADJUSTMENTS
   ========================================================================== */

@media (prefers-color-scheme: dark) {
  i-thir {
    --thir-color-bg: oklch(20% 0 0);
    --thir-color-text: oklch(90% 0 0);
  }
  
  i-thir[effect="embossed"],
  i-thir[effect="raised"] {
    box-shadow:
      inset 0 -2px 0 oklch(10% 0 0),
      inset 0 2px 0 oklch(30% 0 0),
      0 4px 8px oklch(0% 0 0 / 0.4);
  }
}
